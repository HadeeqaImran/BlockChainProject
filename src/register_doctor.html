<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Registration</title>
</head>
<body>
    <h1>Doctor Registration</h1>
    <form id="doctorForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br><br>
        <label for="specialty">Specialty:</label>
        <input type="text" id="specialty" name="specialty" required><br><br>
        <button type="submit">Register</button>
    </form>
    <a href="list_doctors.html">Display</a>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/truffle-contract.js"></script>
    <script src="js/app.js"></script>
    <script>
        $(document).ready(function() {
            $('#doctorForm').submit(async function(event) {
                event.preventDefault(); // Prevent default form submission behavior

                // Retrieve form data
                var _name = $("#name").val();
                var _specialty = $("#specialty").val();
                try {
                    // Make AJAX request to store doctor in the database
                    const response = await $.ajax({
                        type: "POST",
                        url: "http://localhost:8000/api/doctors",
                        data: {
                            name: _name,
                            specialty: _specialty
                        }
                    });

                    // Handle success response
                    console.log("Doctor stored in the database successfully:", response);
                    alert("Doctor registered and stored in the database successfully!");
                } catch (error) {
                    // Handle error response
                    console.error("Failed to store doctor in the database:", error);
                    alert("Failed to store doctor in the database" + name);
                }
            });
        });
    </script>
</body>
</html>
